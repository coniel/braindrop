---
metaTitle: Utils API interface.
metaDescription: Utilities for creating MindDrop extensions.
---

# Utils

<Description>Utilities for creating MindDrop extensions.</Description>

## FieldValue

Helper functions for modifying resource field values.

```ts
import { FieldValue } from '@minddrop/utils';
```

### delete

Deletes a field.

```ts
FieldValue.delete(): FieldValueDelete
```

#### Example

```ts
const update = {
  someField: FieldValue.delete(),
};
```

### arrayUnion

Merges items into an array or creates the array if it does not exist. Does not merge in items which are already present in the existing array.

```ts
FieldValue.arrayUnion<T>(values: T[]): FieldValueArrayUnion
```

#### Example

```ts
const update = {
  someArray: FieldValue.arrayUnion([2, 3]),
};
```

### arrayRemove

Removes items from an array.

```ts
FieldValue.arrayRemove<T>(values: T[]): FieldValueArrayRemove
```

#### Example

```ts
const update = {
  someArray: FieldValue.arrayRemove([1, 2]),
};
```

### arrayFilter

Filters an array.

```ts
FieldValue.arrayFilter<T>(callback: (item: T) => boolean): FieldValueArrayFilter
```

#### Example

```ts
const update = {
  someArray: FieldValue.arrayFilter((item) => item.id !== 'some-id'),
};
```

### objectUnion

Merges values into an object or creates the object if it does not exist. Fields within the merged object can also make use of `FieldValue` mutations.

```ts
FieldValue.objectUnion(value: object): FieldValueObjectUnion
```

#### Example

```ts
const update = {
  someObject: FieldValue.objectUnion({
    foo: 'bar',
    bar: FieldValue.delete(),
  }),
};
```

## applyFieldValues

Updates field values by applying `FieldValue` mutations and merging in regular fields.

```ts
import { applyFieldValues } from '@minddrop/utils';

applyFieldValues<R, C>(resource: R, changes: C): R;
```

<ArgsTable
  data={[
    {
      name: 'resource',
      type: 'Resource',
      required: true,
      description: 'The resource to update.',
    },
    {
      name: 'changes',
      type: 'ResourceChanges',
      required: true,
      description: (
        <span>
          Changes to apply to the resource. Supports{' '}
          <Code>FieldValue</Code> mutations.
        </span>
      ),
    },
  ]}
/>

#### Example

```ts
const resource = {
  title: 'My archived resource',
  drops: ['drop-id'],
  archived: true,
};

const changes = {
  title: 'My resource',
  drops: FieldValue.arrayUnion('drop-id-2'),
  archived: FieldValue.delete(),
};

// Result: { title: 'My resource', drops: ['drop-id', 'drop-id-2'] }
const updated = applyFieldValues(resource, changes);
```

## createUpdate

Creates an update object from a resource object and a changes object.

```ts
import { createUpdate } from '@minddrop/utils';

createUpdate<R, C>(resource: O, changes: C, options?: CreateUpdateOptions): ResourceUpdate<R, C>;

interface ResourceUpdate<R, C> {
  // The resource data before it was updated.
  before: R;

  // The resource data after it was updated.
  after: R;

  // The changes applied to the resource.
  changes: C;
}
```

<ArgsTable
  data={[
    {
      name: 'resource',
      type: 'Resource',
      required: true,
      description: 'The resource to update.',
    },
    {
      name: 'changes',
      type: 'ResourceChanges',
      required: true,
      description: (
        <span>
          Changes to apply to the resource. Supports{' '}
          <Code>FieldValue</Code> mutations.
        </span>
      ),
    },
    {
      name: 'options',
      type: 'CreateUpdateOptions',
      description: 'See below for details.',
    },
  ]}
/>

#### CreateUpdateOptions

<PropsTable
  data={[
    {
      name: 'setUpdatedAt',
      type: 'boolean',
      default: 'false',
      description: (
        <span>
          If <Code>true</Code>, the resource's <Code>updatedAt</Code>{' '}
          field will be set to now.
        </span>
      ),
    },
    {
      name: 'deleteEmptyFields',
      type: 'string[]',
      default: '[]',
      description: (
        <span>
          Fields listed here will be deleted if their value is{' '}
          <Code>undefined</Code>, an empty string, or an empty array.
        </span>
      ),
    },
  ]}
/>

#### Example

```ts
const resource = {
  title: 'My archived resource',
  drops: ['drop-id'],
  archived: true,
};

const changes = {
  title: 'My resource',
  drops: FieldValue.arrayUnion('drop-id-2'),
  archived: FieldValue.delete(),
};

const updated = createUpdate(resource, changes);
```

## removeObjectsFromArray

Filters the given objects out of the provided array by shalowly comapring all of their properties. Does not support objects with objects as properties.

```ts
removeObjectsFromArray<TObject extends Object>(objects: TObject[], objectsToRemove[]): TObject[]
```

<ArgsTable
  data={[
    {
      name: 'objects',
      type: 'Object[]',
      required: true,
      description:
        'The array of objects from which to remove objects.',
    },
    {
      name: 'objectsToRemove',
      type: 'Object[]',
      required: true,
      description: 'The objects to remove from the array.',
    },
  ]}
/>

#### Example

```ts
// The objects
let parents = [
  { type: 'topic', id: 'topic-id-1' },
  { type: 'topic', id: 'topic-id-2' },
  { type: 'topic', id: 'topic-id-3' },
  { type: 'topic', id: 'topic-id-4' },
];

// Remove 'topic-id-1' and 'topic-id-3' objects
parents = removeObjectsFromArray(parents, [
  { type: 'topic', id: 'topic-id-1' },
  { type: 'topic', id: 'topic-id-3' },
]);

// Result: [{ type: 'topic', id: 'topic-id-2' }, { type: 'topic', id: 'topic-id-4' }]
```
