---
metaTitle: PersistentStore API Interface
metaDescription: An interface for retrieving and managing persistently stored data.
---

# PersistentStore

<Description>
  An interface for retrieving and managing persistently stored data.
</Description>

The persistent store is a key-value store which is persisted between app restarts. It has two scopes, `global` and `local`.

Values are automatically namespaced by extension ID in order to prevent seperate extensions from overwiting eachother's data.

The persistent store is intended for small pieces of simple data. If your extension needs to store a large amount of data or individual documents, [register a resource](/docs/extensions/api/core#registerresource) insteasd.

### Global store

The global store is backed up and synced accross devices when using the Sync add-on. It is intended for data which is not specific to an app installation. For example, internally, MindDrop stores a list of root level topic and tag IDs in the global store.

### Local store

The local store is app specific and is not synced across devices. It is intended for app specific data. For example, internally, MindDrop stores the last opened view and sidebar width in the local store.

## Hooks

Hooks provide access to persistently stored data from inside React components. Unlike data accessed using static methods, hooks will cause the component to rerender when the data changes.

### useGlobalStore

Returns an object containing all of the data stored by the extension in the global store.

```ts
useGlobalStore<T>(core: Core): T
```

<ArgsTable core />

### useGlobalStoreValue

Returns a value from the global store.

```ts
useGlobalStoreValue<T>(core: Core, key: string): T
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key of the value to retrieve.',
    },
  ]}
/>

### useLocalStore

Returns an object containing all of the data stored by the extension in the local store.

```ts
useLocalStore<T>(core: Core): T
```

<ArgsTable core />

### useLocalStoreValue

Returns a value from the local store.

```ts
useLocalStoreValue<T>(core: Core, key: string): T
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key of the value to retrieve.',
    },
  ]}
/>

## Static methods

### getGlobal

Retrieves a value from the global store.

```ts
PersistentStore.getGlobal<T>(core: Core, key: string): T
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key of the value to retrieve.',
    },
  ]}
/>

### getLocal

Retrieves a value from the local store.

```ts
PersistentStore.getLocal<T>(core: Core, key: string): T
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key of the value to retrieve.',
    },
  ]}
/>

### setGlobal

Sets a value in the global store and dispaches a `persistent-store:update-global` event.

Supports [`FieldValue`](/docs/extensions/api/utils#fieldvalue) mutations.

```ts
PersistentStore.setGlobal<T>(core: Core, key: string, value: T): void
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key for which to set the value.',
    },
    {
      name: 'data',
      type: 'any',
      required: true,
      description: 'The data to set. Must be serializable into text.',
    },
  ]}
/>

### setLocal

Sets a value in the local store and dispaches a `persistent-store:update-local` event.

Supports [`FieldValue`](/docs/extensions/api/utils#fieldvalue) mutations.

```ts
PersistentStore.setLocal<T>(core: Core, key: string, value: T): void
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key for which to set the value.',
    },
    {
      name: 'data',
      type: 'any',
      required: true,
      description: 'The data to set. Must be serializable into text.',
    },
  ]}
/>

### deleteGlobal

Deletes a key and assotiated data from the global store. Dispatches a `persistent-store:update-global` event.

```ts
PersistentStore.deleteGlobal(core: Core, key: string): void
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key to delete.',
    },
  ]}
/>

### deleteLocal

Deletes a key and assotiated data from the local store. Dispatches a `persistent-store:update-local` event.

```ts
PersistentStore.deleteLocal(core: Core, key: string): void
```

<ArgsTable
  core
  data={[
    {
      name: 'key',
      type: 'string',
      required: true,
      description: 'The key to delete.',
    },
  ]}
/>

### clearGlobal

Permanently deletes all data added by the extension from the global store. Dispatches a `persistent-store:update-global` event.

```ts
PersistentStore.clearGlobal(core: Core): void
```

<ArgsTable core />

### clearLocal

Permanently deletes all data added by the extension from the local store. Dispatches a `persistent-store:update-local` event.

```ts
PersistentStore.clearLocal(core: Core): void
```

<ArgsTable core />

### clearGlobalCache

Clears all data (including data added by other extensions) from the global store cache. This does not delete the persisted data.

Useful for forcefully refreshing the store from a storage adapter.

```ts
PersistentStore.clearGlobalCache(): void
```

### clearLocalCache

Clears all data (including data added by other extensions) from the local store cache. This does not delete the persisted data.

Useful for forcefully refreshing the store from a storage adapter.

```ts
PersistentStore.clearLocalCache(): void
```

### addEventListener

Adds persistent store specific event listeners. Equivalent to calling `addEventListener` directly on `core`, but provides more advanced type definitions.

```ts
PersistentStore.addEventListener(core: Core, event: PersistentStoreEvent, callback: EventListenerCallback): void
```

<ArgsTable
  core
  data={[
    {
      name: 'event',
      type: 'PersistentStoreEvent',
      required: true,
      description:
        'The event type to listen for. See the tag events section below for available events.',
    },
    {
      name: 'callback',
      type: 'EventListenerCallback',
      required: true,
      description:
        'The callback fired when the event occurs. See the tag events section below for the data passed to the callback.',
    },
  ]}
/>

### removeEventListener

Removes persistent store specific event listeners. Equivalent to calling `removeEventListener` directly on `core`, but provides more advanced type definitions.

```ts
Tags.removeEventListener(core: Core, event: PersistentStoreEvent, callback: EventListenerCallback): void
```

<ArgsTable
  core
  data={[
    {
      name: 'event',
      type: 'PersistentStoreEvent',
      required: true,
      description:
        'The event type for which to remove the event listener.',
    },
    {
      name: 'callback',
      type: 'EventListenerCallback',
      required: true,
      description: 'The callback of the event listener to remove.',
    },
  ]}
/>

## PersistentStore events

<EventsTable
  data={[
    {
      name: 'persistent-store:update-global',
      data: 'UpdateGlobalStoreEventData',
      description: 'Dispatched when the global store is updated.',
    },
    {
      name: 'persistent-store:update-local',
      data: 'UpdateLocalStoreEventData',
      description: 'Dispatched when the local store is updated.',
    },
  ]}
/>

#### UpdateGlobalStoreEventData

<InterfaceTable
  data={[
    {
      name: 'before',
      type: 'PersistentStoreData',
      required: true,
      description: 'Global store data before it was changed.',
    },
    {
      name: 'after',
      type: 'PersistentStoreData',
      required: true,
      description: 'Updated global store data.',
    },
    {
      name: 'changes',
      type: 'PersistentStoreChanges',
      required: true,
      description:
        'The changes made to the global store data. See below for details.',
    },
  ]}
/>

#### UpdateLocalStoreEventData

<InterfaceTable
  data={[
    {
      name: 'before',
      type: 'PersistentStoreData',
      required: true,
      description: 'Local store data before it was changed.',
    },
    {
      name: 'after',
      type: 'PersistentStoreData',
      required: true,
      description: 'Updated local store data.',
    },
    {
      name: 'changes',
      type: 'PersistentStoreChanges',
      required: true,
      description:
        'The changes made to the local store data. See below for details.',
    },
  ]}
/>

`PersistentStoreData`

An object containing key-value pairs namespaced by extension ID.

Example

```ts
data = {
  app: {
    topics: ['topic-1-id', 'topic-2-id'],
    tags: ['tag-id'],
  },
  extensionId: {
    foo: 'bar',
  },
};
```

`PersistentStoreChanges`

An object containing new field values namespaced by the extension ID which caused the update, supports [`FieldValue`](/docs/extensions/api/utils#fieldvalue) mutations.

Example

```ts
changes = {
  extensionId: {
    foo: 'bar',
  },
};
```
